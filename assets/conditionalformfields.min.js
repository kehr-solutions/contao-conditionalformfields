!function(n){"use strict";var t="conditionalFormFields",s={fields:[],conditions:{},previousValues:{}};function i(e,i){this.element=e,this.settings=n.extend({},s,i),this._defaults=s,this._name=t,this.init()}n.extend(i.prototype,{init:function(){var e=this;e.initFields(),e.initFieldsets(),n(this.element).on("ajax_change",function(){e.initFields(),e.initFieldsets()})},initFields:function(){var t=this;t.fields={},n(t.settings.fields).each(function(e,i){n(t.element).find('*[name^="'+i+'"]').each(function(){var e=n(this),i=e.attr("name");"[]"==i.substr(i.length-2)?(i=i.substr(0,i.length-2),t.fields[i]instanceof Array||(t.fields[i]=[]),t.fields[i].push(e)):"radio"===e.attr("type")?(t.fields[i]instanceof Array||(t.fields[i]=[]),t.fields[i].push(e)):t.fields[i]=e,n(this).on("change",function(){t.toggleFieldsets()})})})},initFieldsets:function(){var e=this;for(var i in e.fieldsets={},e.fieldsetFields={},e.settings.conditions)e.fieldsets[i]=n(".cffs-"+i),e.fieldsetFields[i]=e.fieldsets[i].find("input, select, textarea");e.toggleFieldsets()},toggleFieldsets:function(){var e=this,i=e.getFieldValues();for(var t in e.settings.conditions){var s="var in_array = function(needle, haystack) { return jQuery.isArray(haystack) ? (jQuery.inArray(needle, haystack) != -1) : false; }; "+e.settings.conditions[t];new Function("values",s)(i)?e.showFieldset(t):e.hideFieldset(t)}},showFieldset:function(e){this.fieldsets[e].show(),n(this.fieldsetFields[e]).each(function(){n(this).attr("disabled",!1)})},hideFieldset:function(e){this.fieldsets[e].hide(),n(this.fieldsetFields[e]).each(function(){n(this).attr("disabled",!0)})},getFieldValues:function(){var i=this,t=i.settings.previousValues,s=null;return n.each(i.fields,function(e){n.isArray(this)?n(this).each(function(){if("radio"===n(this).attr("type")){if(s=i.getFieldValue(this))return t[e]=s,!1}else void 0===t[e]&&(t[e]=[]),(s=i.getFieldValue(this))&&t[e].push(s)}):(s=i.getFieldValue(this))&&(t[e]=s)}),t},getFieldValue:function(e){return"checkbox"!=(e=n(e)).attr("type")&&"radio"!=e.attr("type")||e.is(":checked")?e.val():null}}),n.fn[t]=function(e){return this.each(function(){n.data(this,"plugin_"+t)||n.data(this,"plugin_"+t,new i(this,e))})}}(jQuery,(window,document));